const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CtIfVSHy.js","assets/vendor-Byx97iBs.js","assets/index-BAdRinDA.js"])))=>i.map(i=>d[i]);
import{r as e,R as t,j as s,N as i,L as n,u as r,a as o,b as a,c as l,d as c,M as d,e as u,f as p,O as h,B as m,g as x}from"./vendor-Byx97iBs.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const f={},g=function(e,t,s){let i=Promise.resolve();if(t&&t.length>0){let e=function(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e}))))};document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),n=s?.nonce||s?.getAttribute("nonce");i=e(t.map(e=>{if((e=function(e){return"/"+e}(e))in f)return;f[e]=!0;const t=e.endsWith(".css"),s=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${s}`))return;const i=document.createElement("link");return i.rel=t?"stylesheet":"modulepreload",t||(i.as="script"),i.crossOrigin="",i.href=e,n&&i.setAttribute("nonce",n),document.head.appendChild(i),t?new Promise((t,s)=>{i.addEventListener("load",t),i.addEventListener("error",()=>s(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function n(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return i.then(t=>{for(const e of t||[])"rejected"===e.status&&n(e.reason);return e().catch(n)})};function j(e,t){const s=[],i=`add${t}`;for(let n=0;n<t;n++)for(let r=0;r<t;r++){const o=n+r;if(o>=e&&o<=t){const e=[o,o+1,o>10?o-10:o+2,o>0?o-1:o+3].map(e=>e.toString());s.push({id:`${i}_${n}_${r}`,cid:"math",tid:i,type:"question",text:`${n} + ${r} = ?`,solution:[`${o}`],options:e});const t=[r,r+1,r>10?r-10:r+2,r>0?r-1:r+3].map(e=>e.toString());s.push({id:`${i}_${n}_${r}m`,tid:i,cid:"math",type:"question",text:`${n} + ? = ${o}`,solution:[`${r}`],options:t})}}return{topic:{cid:"math",id:i,name:`Sudėtis iki ${t}`},items:s}}const v=[{width:"76",height:"100",viewBox:"0 0 4.8529978 9.5163436",g:'<g transform="translate(-3.5824384,-2.0766052)">\n    <path style="fill:var(--secondary)"\n       d="m 4.9338213,11.497846 c -0.0179,-0.0582 -0.056,-0.27208 -0.0845,-0.47526 -0.0286,-0.20319 -0.16774,-0.53777 -0.3093,-0.74352 -0.66159,-0.96159 -0.9542,-1.94103 -0.95751,-3.20505 -0.003,-1.0249 0.0859,-1.31234 0.40461,-1.31234 0.10959,0 0.29362,-0.11103 0.421,-0.254 0.23339,-0.26193 0.46043,-0.31521 0.72953,-0.17119 0.11481,0.0614 0.20687,0.0418 0.35685,-0.0762 0.28467,-0.22392 0.50766,-0.24148 0.78216,-0.0616 0.13048,0.0855 0.25758,0.05915 0.30603,0.0841 1.46575,0.754805 0.58141,0.295684 1.23487,1.00221 0.0305,0.03296 0.11597,0.0694 0.20528,0.0694 0.0893,0 0.22668,0.0981 0.30526,0.21804 0.12611,0.19247 0.13336,0.33396 0.0619,1.2065 -0.0754,0.91961 -0.10877,1.04781 -0.47959,1.84049 -0.31424,0.67175 -0.39857,0.94494 -0.39857,1.29117 v 0.43913 l -0.40217,0.002 c -0.22119,8.4e-4 -0.76412,0.0573 -1.2065,0.12548 -0.98084,0.15117 -0.92955,0.15005 -0.96926,0.0212 z"\n    /></g>'},{width:"76",height:"100",viewBox:"0 0 4.8518581 9.4434147",g:'<path style="fill:var(--secondary)" d="m 3.2881648,9.39972 c -0.10343,-0.0575 -1.22839,-0.20526 -2.19656,-0.28847 -0.19370001,-0.0166 -0.20609001,-0.0462 -0.18510001,-0.4417 0.0185,-0.34807 -0.0319,-0.52825 -0.2818,-1.00766 -0.39226,-0.75256 -0.52883,-1.25793 -0.59823,-2.21378 -0.0686,-0.94404 -0.0218,-1.11083 0.35589,-1.26863 l 0.29451,-0.12305 -0.0523,-0.56772 c -0.0288,-0.31224 -0.0898,-0.98681 -0.13572,-1.49905 -0.0459,-0.51223 -0.10076,-1.0939 -0.12195,-1.29259 C 0.32280479,0.28327 0.52303479,0 0.85968479,0 1.2952548,0 1.3582848,0.14416 1.5635148,1.60973 c 0.10622,0.75859 0.23219,1.4183 0.27991,1.46602 0.0592,0.0593 0.13651,0.0418 0.24361,-0.0551 0.19805,-0.17924 0.55624,-0.18277 0.73179,-0.007 0.10459,0.10459 0.22746,0.12196 0.54949,0.0777 0.38903,-0.0535 0.42921,-0.0408 0.64733,0.20395 0.13228,0.14846 0.31649,0.261 0.42724,0.261 0.32121,0 0.40772,0.28657 0.40897,1.35466 0.001,1.17506 -0.19308,1.86761 -0.82367,2.93341 -0.26,0.43946 -0.43297,0.84717 -0.47666,1.12358 -0.0794,0.50218 -0.0941,0.52624 -0.26336,0.43207 z"/>'},{width:"76",height:"100",viewBox:"0 0 4.8409834 9.8105488",g:'<path style="fill:var(--secondary)" d="m 2.3856038,9.6843797 c -0.46567,-0.0632 -0.98954,-0.11985 -1.16417,-0.12594 l -0.31750001,-0.0111 v -0.43961 c 0,-0.32874 -0.0728,-0.58777 -0.28852,-1.02718 -0.41218,-0.83939 -0.53934,-1.32172 -0.59634,-2.26185 -0.0564,-0.93092 -0.004,-1.10129 0.38045,-1.2353 l 0.26117,-0.091 -0.0545,-0.61637 c -0.03,-0.339 -0.10702,-1.1684097 -0.17116,-1.8431397 -0.13573,-1.42782 -0.0885,-1.60955 0.4182,-1.60955 0.36385001,0 0.49595001,0.16545 0.56474001,0.7073 0.27715,2.1830997 0.32606,2.4372697 0.47876,2.4881697 0.10509,0.035 0.13746,-0.20919 0.28322,-2.1371397 0.0528,-0.6985 0.13489,-1.31762 0.18239,-1.37583 C 2.4098438,0.04764 2.5900138,0 2.7627138,0 c 0.50653,0 0.5397,0.14115 0.4333,1.84394 -0.0499,0.79833 -0.0907,1.5134897 -0.0907,1.5892297 0,0.11291 0.0588,0.12778 0.3266,0.0825 0.29275,-0.0495 0.34921,-0.0283 0.54486,0.20422 0.1376,0.16353 0.29743,0.25941 0.43243,0.25941 0.3469,0 0.43178,0.2663 0.43178,1.35466 0,0.84558 -0.0315,1.06657 -0.23932,1.67985 -0.13162,0.38839 -0.40481,0.97894 -0.60709,1.31233 -0.20227,0.33339 -0.38986,0.71093 -0.41685,0.83899 -0.027,0.12806 -0.0688,0.32808 -0.093,0.4445 -0.0242,0.11642 -0.0909,0.2067 -0.14816,0.20063 -0.0573,-0.006 -0.48522,-0.0627 -0.95089,-0.12591 z" />'},{width:"76",height:"100",viewBox:"0 0 4.9298683 9.8242179",g:'<path style="fill:var(--secondary)"\n       d="m 2.9360489,9.8038385 c -0.0151,-0.0151 -0.40625,-0.069 -0.86925,-0.11969 -0.46299,-0.0507 -0.918,-0.10341 -1.01113,-0.11704 -0.14477,-0.0212 -0.16503,-0.0775 -0.13964,-0.38833 0.0241,-0.29535 -0.0448,-0.51875 -0.36726,-1.19118 -0.41931,-0.87426 -0.54329,-1.45046 -0.54866000206,-2.54995 C -0.0018911,4.9462885 0.0223089,4.8534285 0.1855089,4.7391485 c 0.10349,-0.0725 0.25924,-0.1318 0.34611,-0.1318 0.13454,0 0.15087,-0.047 0.1102,-0.3175 -0.0263,-0.17462 -0.10923,-1.03461 -0.18438,-1.91109 -0.12929,-1.50776995 -0.12869,-1.60238995 0.0111,-1.75683995 0.17954,-0.19839 0.64885,-0.21694 0.80257,-0.0317 0.06,0.0723 0.17755,0.68912995 0.26115,1.37064995 0.17649,1.43878 0.22958,1.71516 0.32949,1.71516 0.13733,0 0.16185,-0.14567 0.25789,-1.53231 0.0529,-0.76378 0.12255,-1.52172995 0.15477,-1.68433995 0.0973,-0.49089 0.63846,-0.62499 0.89678,-0.22222 0.0891,0.13889 0.0991,0.3411 0.0443,0.89886995 -0.13649,1.39162 -0.18757,2.58426 -0.10697,2.49767 0.0433,-0.0466 0.25776,-0.57997 0.47647,-1.18534 0.54894,-1.51940995 0.54869,-1.51898995 0.92363,-1.55027995 0.27148,-0.0227 0.32635,0.004 0.39726,0.19007995 0.0656,0.17255 0.006,0.46081 -0.29572,1.42329 -0.20788,0.6638 -0.37832,1.26883 -0.37874,1.3445 -4.8e-4,0.0851 0.0952,0.15677 0.25097,0.18793 0.31456,0.0629 0.37141,0.25658 0.3767,1.28315 0.006,1.13325 -0.26079,2.02793 -0.92085,3.09006 -0.23974,0.38579 -0.35459,0.67657 -0.38455,0.97367 -0.0413,0.40998 -0.0515,0.42388 -0.31647,0.43207 -0.15056,0.005 -0.2861,-0.004 -0.30119,-0.019 z"\n    />'},{width:"76",height:"100",viewBox:"0 0 5.686152 9.8028002",g:'<g transform="translate(-3.2477354,-1.849306)">\n    <path style="fill:var(--secondary)"\n       d="m 5.4629863,11.543996 -1.05833,-0.0923 0.0243,-0.3741 c 0.0204,-0.3141 -0.0369,-0.47938 -0.35717,-1.03064 -0.29754,-0.5120796 -0.43818,-0.8937996 -0.63916,-1.7347796 -0.28993,-1.2132 -0.27473,-1.28689 0.30493,-1.47819 0.34318,-0.11326 0.33521,0.0416 0.11311,-2.19751 -0.18688,-1.88405 -0.16818,-2.05563 0.23514,-2.15686 0.29375,-0.0737 0.58381,0.14145 0.64628,0.47943 0.0285,0.15399 0.12868,0.79148 0.22271,1.41664 0.094,0.62517 0.18968,1.15539 0.21257,1.17828 0.0229,0.0229 0.0416,-0.72673 0.0416,-1.66583 0,-1.59455 0.0112,-1.71864 0.16933,-1.87677 0.21939,-0.21939 0.52447,-0.21568 0.72771,0.009 0.14524,0.16044 0.16427,0.35057 0.19124,1.91033 0.0165,0.95268 0.0444,1.71766 0.0622,1.69995 0.0177,-0.0177 0.13028,-0.62019 0.25015,-1.33883 0.11988,-0.71864 0.25793,-1.41013 0.30679,-1.53664 0.1523,-0.39434 0.69959,-0.41552 0.79615,-0.0308 0.0422,0.16795 -0.0914,1.64107 -0.26937,2.97017 -0.0898,0.67111 0.0268,0.41443 0.38395,-0.84479 0.1823,-0.64279 0.38218,-1.20086 0.44418,-1.24016 0.2952,-0.18714 0.66344,-0.0189 0.66259,0.30271 -5.3e-4,0.20294 -0.54971,2.70331 -0.61802,2.81385 -0.0255,0.0412 -0.0902,0.47321 -0.14372,0.95993 -0.10836,0.98469 -0.3558,1.78188 -0.80906,2.6064696 -0.17331,0.3153 -0.32321,0.72548 -0.35105,0.96062 -0.0448,0.37821 -0.0659,0.4093 -0.26965,0.39678 -0.12157,-0.007 -0.69729,-0.0551 -1.27937,-0.10583 z"\n    /></g>'},{width:"76",height:"100",viewBox:"0 0 7.6573344 9.8083534",g:'<g transform="translate(-3.2477354,-1.849306)">\n    <path style="fill:var(--secondary)"\n       d="m 7.4877876,11.557936 -1.13132,-0.0836 0.0412,-0.36569 c 0.0415,-0.36797 -0.0788,-0.69873 -0.48848,-1.34295 -0.14878,-0.23399 -1.13305,-1.46674 -1.37059,-1.7166 -0.0564,-0.0594 -0.24726,-0.28797 -0.42406,-0.508 -0.17679,-0.22004 -0.34111,-0.41912 -0.36514,-0.4424 -0.62132,-0.60196 -0.67629,-1.27 -0.1045,-1.27 0.33174,0 0.68946,0.23834 1.47489,0.98269 0.41242,0.39085 0.78746,0.71064 0.83341,0.71064 0.13102,0 0.10178,-0.81852 -0.10191,-2.85357 l -0.18817,-1.8799 0.19978,-0.17326 c 0.24537,-0.21282 0.43341,-0.21941 0.65971,-0.0232 0.13598,0.11794 0.21136,0.39044 0.35162,1.2712 0.0982,0.6166 0.17853,1.2158 0.17853,1.33155 0,0.11576 0.0381,0.21046 0.0847,0.21046 0.0534,0 0.0847,-0.58638 0.0847,-1.58982 0,-1.76624 0.0508,-1.96618 0.49967,-1.96618 0.4705,0 0.50917,0.1398 0.57533,2.08022 0.0428,1.25555 0.0803,1.6734 0.12849,1.43345 0.0374,-0.18627 0.16284,-0.868 0.27865,-1.51496 0.11582,-0.64695 0.25348,-1.22798 0.30592,-1.29116 0.22493,-0.27103 0.75194,-0.0387 0.75194,0.33142 0,0.0991 -0.0786,0.80345 -0.1746,1.5652 -0.25953,2.05875 -0.20359,2.03806 0.40072,-0.14817 0.1921304,-0.69509 0.2526404,-0.7766 0.5541304,-0.74644 0.45831,0.0459 0.46653,0.17178 0.11313,1.73237 -0.17766,0.78452 -0.37401,1.80741 -0.43633,2.27307 -0.14399,1.07592 -0.3859704,1.86871 -0.8088504,2.65002 -0.20099,0.37134 -0.35432,0.78531 -0.38415,1.03717 -0.0427,0.36085 -0.0745,0.41712 -0.22835,0.4046 -0.0983,-0.008 -0.6878,-0.0522 -1.31003,-0.0982 z"\n    /></g>'}];function y(e){const t={cid:"math",id:`numbers${e}`,name:`Skaičiai iki ${e}`},s=[];for(let i=0;i<=e;i++){const n=0===i?[v[0]]:[],r=Math.floor(i/5);for(let e=0;r>0&&e<r;e++)n.push(v[5]);const o=i%5;o>0&&n.push(v[o]);const a=e>10?" ":"",l=[i,i+1,i+2].map(e=>e.toString());s.push({id:`${t.id}_${i}`,tid:t.id,cid:t.cid,type:"question",svg:n,text:`⚫${a}`.repeat(i)+`⚪${a}`.repeat(e-i),solution:[i.toString()],options:l})}return{topic:t,items:s}}function b(e,t,s=2){const i=[],n=`div${t}`;for(let r=e;r<t;r++)for(let e=2;e<t;e++){const o=r/e;if(o>=s&&o<=t&&r%e===0){const t=[o,o+1,o>10?o-10:o+2,o>0?o-1:o+3].map(e=>e.toString());i.push({id:`${n}_${r}_${e}`,tid:n,cid:"math",type:"question",text:`${r} ÷ ${e} = ?`,solution:[`${o}`],options:t});const s=[e,e+1,e>10?e-10:e+2,e>0?e-1:e+3].map(e=>e.toString());i.push({id:`${n}_${r}_${e}m`,tid:n,cid:"math",type:"question",text:`${r} ÷ ? = ${o}`,solution:[`${e}`],options:s})}}return{topic:{cid:"math",id:n,name:`Dalyba iki ${t}`},items:i}}function w(e,t){const s=[],i=`mul${t}`;for(let n=2;n<t;n++)for(let r=2;r<t;r++){const o=n*r;if(o<=t&&o>=e){const e=[o,o+1,o>10?o-10:o+2,o>0?o-1:o+3].map(e=>e.toString());s.push({id:`${i}_${n}_${r}`,tid:i,cid:"math",type:"question",text:`${n} × ${r} = ?`,solution:[`${o}`],options:e});const t=[r,r+1,r>10?r-10:r+2,r>0?r-1:r+3].map(e=>e.toString());s.push({id:`${i}_${n}_${r}m`,tid:i,cid:"math",type:"question",text:`${n} × ? = ${o}`,solution:[`${r}`],options:t})}}return{topic:{cid:"math",id:i,name:`Daugyba iki ${t}`},items:s}}function N(e,t){const s=[],i=`sub${t}`;for(let n=0;n<t;n++)for(let r=0;r<t;r++){const o=n-r;if(o>=e){const e=[o,o+1,o>10?o-10:o+2,o>0?o-1:o+3].map(e=>e.toString());s.push({id:`${i}_${n}_${r}`,tid:i,cid:"math",type:"question",text:`${n} - ${r} = ?`,solution:[`${o}`],options:e});const a=[r,r+1,r>10?r-10:r+2,r>0?r-1:r+3].map(e=>e.toString());s.push({id:`${i}_${t}_${n}_${r}m`,tid:i,cid:"math",type:"question",text:`${n} - ? = ${o}`,solution:[`${r}`],options:a})}}return{topic:{cid:"math",id:i,name:`Atimtis iki ${t}`},items:s}}const k={id:"math",name:"Matematika",svg:'\n  <rect style="fill:#fff" width="100%" height="100%" />\n  <path\n    d="M 640,0 H 0 v 480 h 640 m -296.35301,-376.90612 29.3332,-29.333393 37.3334,37.333393 37.3334,-37.333393 29.3332,29.333393 -37.3332,37.3332 37.3332,37.3334 -29.3332,29.3334 -37.3334,-37.3334 -37.3334,37.3334 -29.3332,-29.3334 37.3332,-37.3334 -37.3332,-37.3332 m -181.3334,16 h 133.3334 v 40 h -133.3334 v -40 m 141.3334,221.3332 h -53.3334 v 53.3334 h -40 v -53.3334 h -53.3334 v -40 h 53.3334 v -53.3332 h 40 v 53.3332 h 53.3334 v 40 m 173.3332,32 h -133.3332 v -40 h 133.3332 v 40 m 0,-64 h -133.3332 v -40 h 133.3332 z"\n    style="fill: #807fe2"\n  />'},C=[],_=[];[y(5),y(10),y(20),j(0,10),j(11,20),j(21,100),N(0,10),N(11,20),N(21,100),w(0,10),w(11,20),w(21,100),b(1,10,1),b(11,20),b(21,100)].forEach(e=>{C.push(e.topic),_.push(...e.items)});const $={course:k,topics:C,items:_};function S(s,i,n=""){const r=e.createContext(null),o=e.createContext(null);return[({children:n})=>{const[a,l]=e.useReducer(s,i);return t.createElement(o.Provider,{value:l},t.createElement(r.Provider,{value:a},n))},function(){const e=t.useContext(r);if(null===e)throw new Error(`${n} useState must be used within a Provider`);return e},function(){const e=t.useContext(o);if(!e)throw new Error(`${n} useDispatch must be used within a Provider`);return e}]}const q=e=>["math","en","it"].includes(e);function I(e,t){return(t?e.find(e=>e[0]===t):void 0)||e[Math.floor(Math.random()*e.length)]}function B(e,t,s=[]){if((e=Array.from(new Set(e.filter(e=>!s.includes(e))))).length<=t)return P(e);const i=[],n=new Set;for(;i.length<t;){const t=I(e);n.has(t)||(i.push(t),n.add(t))}return i}function E(e,t){const s=new Set(e),i=new Set(t);if(s.size!==i.size)return!1;for(const n of s)if(!i.has(n))return!1;return!0}function P(e){const t=[...e];for(let s=t.length-1;s>0;s--){const e=Math.floor(Math.random()*(s+1));[t[s],t[e]]=[t[e],t[s]]}return t}function z(e,t){return e.reduce((e,s)=>{const i=s[t];return"string"==typeof i&&(e[i]=s),e},{})}function T(e,t,s){return e.reduce((e,i)=>{const n=i[t]||s;return"string"==typeof n&&(e[n]=e[n]||[],e[n].push(i)),e},{})}function A(e,t=!1){const s={"d.":Math.floor(e/86400),"val.":Math.floor(e/3600)%24,"min.":Math.floor(e/60)%60,s:+(e%60).toFixed(1)},i=Object.entries(s).filter(e=>0!==e[1]).map(e=>e[1]+" "+e[0]);return t?i:i.join(" ")}function O(e){return e?e.replace(/[.?!]+$/g,""):""}function F(e){return e.replace(/^.:/g,"")}function L(e){return e.replace(/[ .?,!:;/]/g,"-")}const D=e=>{const t=[];let s=[];const i=()=>{s.length>0&&t.push(s.join("")),s=[]};for(let n=0;n<e.length;n++){const t=e[n];" "===t?i():(s.push(t),"’"===t&&i())}return i(),t},M=e=>Math.abs(e.split("").map(e=>e.charCodeAt(0)).reduce((e,t)=>e+((e<<7)+(e<<3))^t)).toString(16);function Q(e,t=!1){return e.replace(/\[(\d+)\]/g,".$1").split(".").filter(Boolean).filter(e=>!(t&&/^\d+$/.test(e)))}const R=(e,t,s)=>{if(0===e.length)return s;const[i,...n]=e,r=Number(i);if(!isNaN(r)){const e=Array.isArray(t)?[...t]:[];return e[r]=R(n,e[r],s),e}return{...t,[i]:R(n,t?.[i]??{},s)}},V=(e,t)=>e.reduce((e,t)=>{if(null==e)return;const s=Number(t);return!isNaN(s)&&Array.isArray(e)?e[s]:e[t]},t);const W=e=>Object.fromEntries(Object.entries(e).filter(([,e])=>void 0!==e)),H="courses/load-success",U="courses/import-success",J="courses/toggled",K=(e,t=[],s=[],i=[])=>{const n=[...e.allQuestions.filter(e=>void 0===i.find(t=>t.id===e.id)),...i],r=[...e.courses.filter(e=>void 0===t.find(t=>t.id===e.id)),...t],o=[...e.topics.filter(e=>void 0===s.find(t=>t.id===e.id)),...s],a=T(o,"cid"),l=T(n,"tid"),c=T(n,"cid");return o.forEach(e=>{l[e.id]||(l[e.id]=[])}),r.forEach(e=>{a[e.id]||(a[e.id]=[]),c[e.id]||(c[e.id]=[])}),{courses:r,coursesById:z(r,"id"),topics:o,topicsById:z(o,"id"),topicsByCourseId:a,allQuestions:n,questionsById:z(n,"id"),questionsByParentId:T(n,"pid"),questionsByTopicId:l,questionsByCourseId:c}};const G=new class{dbName="";storeName="";db=null;constructor(e="_mokutis_db",t="docs"){this.dbName=e,this.storeName=t,this.db=null}async _init(){return this.db?this.db:new Promise((e,t)=>{const s=indexedDB.open(this.dbName,1);s.onupgradeneeded=e=>{const t=e.target.result;t.objectStoreNames.contains(this.storeName)||t.createObjectStore(this.storeName,{keyPath:"id"})},s.onsuccess=t=>{this.db=t.target.result,e(this.db)},s.onerror=e=>t(e.target.error)})}async get(e){const t=await this._init();return new Promise((s,i)=>{const n=t.transaction(this.storeName,"readonly").objectStore(this.storeName).get(e);n.onsuccess=e=>{if(!e.target.result){const e=new Error;e.status=404,i(e)}s(e.target.result)},n.onerror=e=>i(e.target.error)})}async put(e){const t=await this._init();return new Promise((s,i)=>{const n=t.transaction(this.storeName,"readwrite").objectStore(this.storeName),r={...e,_rev:(e._rev||0)+1},o=n.put(r);o.onsuccess=()=>s(r),o.onerror=e=>i(e.target.error)})}},Y=async()=>{try{const{courses:e}=await G.get("courses"),{topics:t}=await G.get("topics"),{items:s}=await G.get("items");return{courses:e||[],topics:t||[],items:s||[]}}catch(e){if(404!==e.status)throw e;return{courses:[],topics:[],items:[]}}},X=async({courses:e,topics:t,items:s},i)=>{if(e.some(e=>q(e.id)))throw new Error;if((0===e.length||0===t.length||0===s.length)&&!i?.allowEmpty)throw new Error("No data to save");if(e.some(e=>!e.id.trim()))throw new Error("Invalid course ID");if(t.some(e=>!e.id.trim()||!e.cid.trim()))throw new Error("Invalid topic CID");if(s.some(e=>!e.id.trim()||!e.cid.trim()||!e.tid.trim()))throw new Error("Invalid item CID");if(e.length!==new Set(e.map(e=>e.id)).size)throw new Error("Duplicate course IDs");if(t.length!==new Set(t.map(e=>e.id)).size)throw new Error("Duplicate topic CIDs");if(s.length!==new Set(s.map(e=>e.id)).size)throw new Error("Duplicate item CIDs");if(e.some(e=>!e.id||!e.name))throw new Error("Course ID and Name are required");return Promise.all([G.put({id:"courses",courses:e}),G.put({id:"topics",topics:t}),G.put({id:"items",items:s})])},Z=e=>{if("string"==typeof e)return e;if(!e.text)throw new Error("Missing text");return e.text},ee=(e,t)=>e.reduce((e,[s,i])=>(i===t&&e.push(F(s)),e),[]);function te(e){const t=[],s=[],i=[],n=[];for(const[o,a]of Object.entries(e)){const e="object"==typeof a?{text:a.text??"",...a}:{text:a},r=Z(e);t.push(F(o)),s.push(r),i.push([o,e]),n.push([o,r])}const r={};for(const[,o]of n)r[o]=ee(n,o);return{lang_words:t,lt_words:s,pairs:n,blacklist:r,rawPairs:i}}function se(e,t,s){const i=te(s),{rawPairs:n,lang_words:r,lt_words:o,blacklist:a}=i,l=[];for(const[c,d]of n){const{text:s,extraOptions:i=[],table:n,...u}=d,p=c.startsWith("S:"),h=p||c.startsWith("s:"),m=L(`${t}_${c}`),x=L(`${t}__${c}`),f=F(c);if(!p){const i=[s,...B(o,2,[s])];l.push({id:m,tid:t,cid:e,type:"question",text:f,options:i,solution:[s],speak:"text",speakLang:e,vocab:!0,table:n,...u})}if(h){const r=[...D(O(f)),...i];l.push({id:x,pid:m,tid:t,cid:e,type:"sentence",text:s,solution:f,words:r,table:n,vocab:p?{text:f,solution:s}:void 0})}else{const i=[f,...B(r,2,a[s])];l.push({id:x,tid:t,cid:e,type:"question",text:s,options:i,solution:[f],speak:"options",speakLang:e,table:n})}if(d.conjugations){const s=["io","tu","lui/lei","noi","voi","loro"],i=["present","past","future"],n=["presente","passato","futuro"];d.conjugations.present.includes("-")||i.forEach((i,r)=>{s.forEach((s,o)=>{const a=d.conjugations?.[i];if(a){const c=L(`${m}__${s}__${i.slice(0,2)}`),d=a[o],u=a.filter(e=>e!==d);l.push({id:c,pid:m,tid:t,cid:e,type:"question",text:`${s} __ (${n[r]})`,solution:[d],options:[...B(u,2)],speak:"options",speakLang:e})}})})}}return{questions:l,dict:i}}te({});const[ie,ne,re]=S((e,t)=>{switch(t.type){case H:return K({courses:[],topics:[],allQuestions:[]},t.payload.courses,t.payload.topics,t.payload.items);case U:return K(e,t.payload.courses,t.payload.topics,t.payload.items);case J:return{...e,courses:e.courses.map(e=>e.id===t.payload?{...e,isEnabled:!1===e.isEnabled}:e)};default:throw new Error(`Unknown courses event: ${JSON.stringify(t)}`)}},{courses:[],coursesById:{},topics:[],topicsById:{},topicsByCourseId:{},allQuestions:[],questionsById:{},questionsByParentId:{},questionsByTopicId:{},questionsByCourseId:{}},"courses"),oe=()=>{const t=re(),s=e.useCallback(async()=>{const e=(await g(async()=>{const{default:e}=await import("./index-CtIfVSHy.js");return{default:e}},__vite__mapDeps([0,1]))).default,s=(await g(async()=>{const{default:e}=await import("./index-BAdRinDA.js");return{default:e}},__vite__mapDeps([2,1]))).default,i=await Y();let n={};try{const e=window.localStorage.getItem("extensions");n=e?JSON.parse(e):n}catch{}const r=[$.course,e.course,s.course,...i.courses].map(e=>({...e,isEnabled:!1!==n[e.id]})),o=[...$.topics,...e.topics,...s.topics,...i.topics],a=[...$.items,...e.items,...s.items,...i.items];t({type:H,payload:{courses:r,topics:o,items:a}})},[t]),i=e.useCallback(async e=>{const s=new Set(e.courses.map(e=>e.id)),i=await Y(),n={courses:[...i.courses.filter(e=>!s.has(e.id)),...e.courses.map(W)],topics:[...i.topics.filter(e=>!s.has(e.cid)),...e.topics.map(W)],items:[...i.items.filter(e=>!s.has(e.cid)),...e.items.map(W)]};await X(n),t({type:U,payload:n})},[t]),n=e.useCallback(e=>{t({type:J,payload:e})},[t]),r=e.useCallback(async e=>{if(q(e))throw new Error;const t=await Y(),i={courses:t.courses.filter(t=>t.id!==e&&t.id),topics:t.topics.filter(t=>t.cid!==e&&t.cid&&t.id),items:t.items.filter(t=>t.cid!==e&&t.cid&&t.tid&&t.id)};await X(i,{allowEmpty:!0}),s()},[s]);return{loadCourses:s,importCourse:i,toggleCourse:n,deleteCourse:r}},ae="2.1.7",le="Audrius Kovalenko",ce=!1,{navigator:de,screen:ue,matchMedia:pe,speechSynthesis:he}=window,me=de.userAgent||"",xe=-1!==me.indexOf("Chrome/")&&!("brave"in de)&&!/CriOS|Edg|OPR|Brave|Vivaldi|SamsungBrowser|YaBrowser/i.test(me),fe=async(e,t,s,i=!0,n={},r=10,o=[])=>{const a=t[s];let l="function"==typeof a[0].generate?a[0].generate():function(e,t,s={},i=!0){if(!i)return e;if(e.length<=t)return B(e,t);const{notMastered:n,failed:r,seen:o}=ge(e,s),a=z(e,"id");for(;n.length<t;){const e=r.length?r:o,t=I(e);e.splice(e.indexOf(t),1),n.push(a[t])}return B(n,t)}(a,r||10,n,i);for(const d of l)Object.hasOwn(e,d.id)||(e[d.id]=d);o.length&&(l=o.map(t=>e[t]));const c=Date.now();return{id:c,start:c,isFinished:!1,topicId:s,questions:l.map(e=>{return{...e,options:e.options?P((t=[...e.options,...e.solution],[...new Set(t)])):void 0,words:e.words?P(e.words):void 0};var t})}};function ge(e,t={}){const s=new Set(e.map(e=>e.id)),{seen:i,failed:n}=Object.entries(t).reduce((e,[t,i])=>{if(s.has(t)){e[0===i?"seen":"failed"].push(t)}return e},{seen:[],failed:[]}),r=e.filter(e=>!i.includes(e.id)||n.includes(e.id)),o=new Set(r.map(e=>e.id)),a=n.filter(e=>!o.has(e));let l=100*i.length/s.size;return l>100&&(l=100),{progress:l,seen:i,failed:a,notMastered:r}}function je(e){let t=0,s=0;const i={},n={};for(const r of e.questions){let e=!1;if("sentence"===r.type)n[r.id]=r.solution,e=O(r.givenSolution)===O(r.solution);else{if(void 0!==r.type&&"question"!==r.type&&"story"!==r.type)throw new Error("Don't know how to grade");{const t=(r.givenSolution||[]).map(e=>r.options[e]);e=E(r.solution,t),n[r.id]=r.options.map((e,t)=>r.solution.includes(e)?t:-1).filter(e=>e>-1)}}e?t++:(i[r.id]=!0,s++)}return{correctCount:t,wrongCount:s,wrong:i,correct:n,explanation:{}}}const ve=async e=>G.put(e),ye="profile/load-success",be="profile/save-success",[we,Ne,ke]=S((e,t)=>{switch(t.type){case ye:return{...t.payload};case be:return{...e,...t.payload};default:throw new Error(`Unknown profile event: ${JSON.stringify(t)}`)}},{id:"default",stats:{}},"profile"),Ce=()=>{const t=ke();return{loadProfile:e.useCallback(async()=>{const e=await(async(e="profile_default")=>{try{return await G.get(e)||{id:e,stats:{}}}catch(t){if(404!==t.status)throw t;const s={id:e,name:"default",stats:{}};return G.put(s).then(()=>G.get(e))}})();t({type:ye,payload:e})},[t]),updateProfile:e.useCallback(async e=>{const s=await ve(e);t({type:ye,payload:s})},[t]),resetProfileStats:e.useCallback(async e=>{const s=await ve({...e,stats:{}});t({type:ye,payload:s})},[t])}};function _e(){return s.jsxs("div",{className:"flex bottom justify-evenly surface-container",children:[s.jsx(i,{to:"/",end:!0,children:s.jsx("button",{className:"circle transparent responsive",children:s.jsx("i",{children:"home"})})}),s.jsx(i,{to:"/stats",children:s.jsx("button",{className:"circle transparent responsive",children:s.jsx("i",{children:"analytics"})})})]})}const $e=(...e)=>e.filter(Boolean).join(" ");function Se(t,s,i=[],n=400){const[r,o]=e.useState(t),[a,l]=e.useState({}),[c,d]=e.useState([]),[u,p]=e.useState({}),[h,m]=e.useState({}),x=e.useRef(new Map),f=e.useCallback(async e=>{const t=Q(e),i=V(Q(e,!0),s);if(!i)return;const n=V(t,r);let o,a;"function"==typeof i?o=i:i?.validator&&(o=i.validator,a=i.transform);const c=a?a(n):n;if(o){m(e=>R(t,e,!0));const e=await o(c,r);return m(e=>R(t,e,!1)),l(s=>R(t,s,e)),e}},[r,s]),g=e.useCallback(e=>(x.current.has(e)||x.current.set(e,function(e,t){let s;return(...i)=>{clearTimeout(s),s=setTimeout(()=>e(...i),t)}}(async()=>{await f(e)},n)),x.current.get(e)),[f,n]),j=e.useCallback(async()=>{const e=await Promise.all(i.map(e=>e(r)));return d(e.filter(e=>!!e)),e.every(e=>!e)},[r,i]),v=e.useCallback(async()=>{const e=async(t,i=[])=>{const n=i.filter(e=>!/^\d+$/.test(e)),a=V(n,s),l=i.join("."),c=V(i,r);let d=c;a?.transform&&(d=a.transform(c),o(e=>R(i,e,d))),("function"==typeof a||a?.validator)&&await f(l),Array.isArray(t)?await Promise.all(t.map((t,s)=>e(t,[...i,String(s)]))):t&&"object"==typeof t&&await Promise.all(Object.keys(t).map(s=>e(t[s],[...i,s])))};await e(r);return await j()&&!qe(a)},[r,a,s,f,j]),y=e.useCallback(e=>t=>{const s=Q(e);o(e=>R(s,e,t)),g(e)(t)},[g]),b=e.useCallback(e=>async()=>{const t=Q(e);p(e=>R(t,e,!0));const i=V(Q(e,!0),s),n=i?.transform;if(n){const e=n(V(t,r));o(s=>R(t,s,e))}await f(e),await j()},[r,s,f,j]),w=e.useCallback((e,t)=>{const s=Q(e);o(e=>{const i=V(s,e)||[];return R(s,e,[...i,t])})},[]),N=e.useCallback((e,t)=>{const s=Q(e);o(e=>{const i=V(s,e)||[];return R(s,e,i.filter((e,s)=>s!==t))})},[o]),k=e.useCallback(async(e,t)=>{const i=Q(e),n=V(Q(e,!0),s),r=n?.transform,a=r?r(t):t;o(e=>R(i,e,a)),await f(e),await j()},[s,f,j]),C=e.useCallback(e=>{const t=Q(e);return{value:V(t,r)??"",error:V(t,a),touched:V(t,u),loading:V(t,h),onChange:y(e),onBlur:b(e)}},[r,a,u,h,y,b]);return{values:r,setValue:k,errors:a,formErrors:c,touched:u,loading:h,handleChange:y,handleBlur:b,addToArray:w,removeFromArray:N,validateAll:v,register:C}}function qe(e){return!!e&&("string"==typeof e?!!e:Array.isArray(e)?e.some(e=>qe(e)):"object"==typeof e&&Object.values(e).some(e=>qe(e)))}const Ie={home:"Pradžia",about:"Apie",extensions:"Plėtiniai",edit:"Redagavimas",stats:"Statistika",learned:"Išmokta",accuracy:"Tikslumas",speed:"Greitis","are.you.sure":"Ar tikrai?",reset:"Trinti statistiką",yes:"Taip",no:"Ne",new:"Kurti",import:"Įkelti",export:"Parsisiųsti",save:"Išsaugoti","multi-table":"Daugybos lentelė","div-table":"Dalybos lentelė",name:"Pavadinimas",shuffle:"Maišyti",course:"Kursas",topics:"Temos",topic:"Tema",question:"Klausimas",questions:"Klausimai",type:"Tipas",option:"Variantas",options:"Variantai",solution:"Atsakymas",text:"Tekstas",icon:"Ikona",story:"Istorija",sentence:"Sakinys",speak:"Įgarsinti","speak-language":"Įgarsinimo kalba","speak-text":"Tekstą","speak-options":"Variantus","speak-text-options":"Tekstą ir Variantus","course.add-topic":"Pridėti temą","course.add-option":"Pridėti variantą","course.add-item":"Pridėti klausimą","course.saved":"Išsaugota sėkmingai","course.save-failed":"Išsaugoti nepavyko","course.imported":"Įkelta sėkmingai","course.import-failed":"Įkelti nepavyko",finish:"Baigti",results:"Rezultatai",repeat:"Pakartoti",next:"Kitas",time:"Laikas","all-correct":"Puikiai!",errors:"Klaidos"},Be=e=>Ie[e]||e,Ee=()=>({t:Be});class Pe{validators=[];transformers=[];validate(e){return this.validators.push(e),this}transform(e){return this.transformers.push(e),this}required(e="Required"){return this.validators.push(t=>null==t||""===t?e:void 0),this}min(e,t){return this.validators.push(s=>s&&s.length<e?t??`Min ${e}`:void 0),this}email(e="Invalid email"){return this.validators.push(t=>t&&!/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(t)?e:void 0),this}oneOf(e,t){return this.validators.push(s=>s&&!e.includes(s)?t||`Must be one of: ${e.join(", ")}`:void 0),this}unique(e,t,s="Must be unique"){return this.validators.push((i,n)=>{if(!i)return;return(V(Q(e),n)||[]).filter(e=>(void 0!==t?e[t]:e)===i).length>1?s:void 0}),this}trim(){return this.transformers.push(e=>"string"==typeof e?e.trim():e),this}lowerCase(){return this.transformers.push(e=>"string"==typeof e?e.toLowerCase():e),this}emailField(){return this.build()}schema(){return this.build()}build(){return{validator:(e,t)=>{for(const s of this.validators){const i=s(e,t);if(i)return i}return""},transform:e=>{let t=e;for(const s of this.transformers)t=s(t);return t}}}}const ze=(e="Required")=>(new Pe).required(e),Te=()=>new Pe;function Ae({onClick:e}){const{t:t}=Ee();return s.jsxs("nav",{className:"drawer",children:[s.jsxs(n,{to:"/about",onClick:e,children:[s.jsx("i",{children:"info"}),s.jsx("span",{className:"max",children:t("about")})]}),s.jsxs(n,{to:"/extensions",onClick:e,children:[s.jsx("i",{children:"extension"}),s.jsx("span",{className:"max",children:t("extensions")})]})]})}const Oe="_header_1f9wy_1",Fe="_nav_1f9wy_5",Le="_tabs_1f9wy_10",De="_toggleColor_1f9wy_14",Me="_icon_1f9wy_21";function Qe(){const t="theme",i="dark",[n,r]=e.useState(()=>window.localStorage.getItem(t)===i),o=n?"nightlight":"light_mode";e.useLayoutEffect(()=>{document.body.classList.toggle(i,n)},[n]);const a=e.useCallback(()=>{r(e=>(window.localStorage.setItem(t,e?"light":i),!e))},[r]);return s.jsx("div",{className:De,children:s.jsxs("label",{className:"flex items-center cursor-pointer relative",children:[s.jsx("input",{type:"checkbox",checked:n,onChange:a,className:"cursor-pointer invisible",name:"color-scheme-dark"}),s.jsx("span",{className:Me,children:s.jsx("i",{className:"fill",children:o})})]})})}function Re({size:e=1,className:t,svg:i}){return s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 480",style:{width:1.5*e+"rem",height:1.5*e+"rem"},className:t,dangerouslySetInnerHTML:{__html:i}})}function Ve({svg:e,iconName:t}){return t?s.jsx("i",{children:t}):e?s.jsx(Re,{className:"responsive",svg:e,size:1.25}):s.jsx("i",{children:"extension"})}function We(){const[t,n]=e.useState(!1),{pathname:o}=r(),{courses:a}=ne(),l=e.useCallback(()=>n(!t),[t,n]);return s.jsxs("div",{className:Oe,children:[s.jsxs("nav",{className:$e("top",Fe),children:[s.jsx("button",{className:"circle transparent",onClick:l,children:s.jsx("i",{children:"menu"})}),s.jsx("div",{className:$e(Le,"tabs max left-align"),children:(a.filter(e=>!1!==e.isEnabled)||[]).map(e=>s.jsx(i,{to:`/${e.id}`,end:e.id.length>0,className:$e("responsive",e.id&&o.includes(`/${e.id}`)&&"active"),children:s.jsx(Ve,{...e})},e.id))}),s.jsx(Qe,{})]}),s.jsxs("div",{children:[s.jsx("div",{className:$e("overlay",t&&"active"),onClick:l}),s.jsx("dialog",{className:$e("left no-padding",t&&"active"),open:t,children:s.jsx(Ae,{onClick:l})})]})]})}function He({children:e}){return s.jsx("h4",{className:"small",children:e})}const Ue="_table_1s1vw_1",Je="_th_1s1vw_14",Ke="_selected_1s1vw_18";function Ge({op:t="mul",title:i="multi-table",x:n=6,y:r=5}){const[o,a]=e.useState({x1:n,y1:r}),{x1:l,y1:c}=o;let d,u="×";return"div"===t?(u="÷",d=l>-1&&c>-1&&`${l*c} ÷ ${l} = ${c}`):d=l>-1&&c>-1&&`${c} × ${l} = ${l*c}`,s.jsxs("div",{className:$e("flex flex-col"),children:[s.jsx(He,{children:i}),s.jsx("table",{className:Ue,children:s.jsx("tbody",{children:Array.from({length:11},(e,t)=>s.jsx("tr",{children:Array.from({length:11},(e,i)=>{const n=t,r=i;let l=Math.max(((e,t)=>e*t)(n,r),n,r);return 0===n&&0===r&&(l=u),s.jsx("td",{onClick:()=>a(e=>t+i===0?{x1:-1,y1:-1}:{y1:t||e.y1,x1:i||e.x1}),className:$e((0===n||0===r)&&Je,(i===o.x1||t===o.y1)&&(o.x1<0||o.y1<0||i<=o.x1&&t<=o.y1)&&Ke),children:l},i)})},t))})}),d&&s.jsx("h5",{className:"center-align",children:d})]})}function Ye({children:e}){return s.jsx(s.Fragment,{children:e})}function Xe(){const{t:t}=Ee(),{questionsByTopicId:i}=ne(),[n,r]=e.useState(!1),o=Object.entries((()=>{const e={version:ae,author:le,standalone:!!pe("(display-mode: standalone)").matches},t=(t,s)=>{void 0!==s&&""!==s&&null!=s&&(e[t]=s)};if(t("vendor",de.vendor),t("platform",de.platform),t("language",de.language),e.tts=xe?"Web Speech API":"OSS",e.userAgent=me,e.screenSize=ue?`${ue.width}x${ue.height}`:"",e.devicePixelRatio=window.devicePixelRatio||1,he&&"function"==typeof he.getVoices){const t=he.getVoices();if(t&&t.length){const s=e=>{const t=e.toLowerCase();return t.includes("italia")||t.includes("english")},i=[];for(let e=0;e<t.length;e++){const n=t[e];s(n.name)&&i.push(`${n.name} (${n.lang})`)}i.length&&(e.voices=i.join(", "))}}return e})()).map(([e,t])=>`${e}: ${t}`).join("\n");return s.jsxs(Ye,{children:[s.jsx(Ye.Header,{title:t("about")}),s.jsxs(Ye.Content,{children:[s.jsx("pre",{children:o}),ce]})]})}function Ze({label:e,error:t,touched:i,loading:n,children:r,className:o=""}){const{t:a}=Ee();return s.jsxs("div",{className:`field border label small ${o}`,children:[r,s.jsx("label",{children:a(e)}),n&&s.jsx("p",{className:"helper",children:"Checking..."}),i&&t&&s.jsx("div",{className:"helper m-0 error-text",children:t})]})}function et(e){const{value:t,onChange:i,onBlur:n,disabled:r,...o}=e;return s.jsx(Ze,{...o,children:s.jsx("input",{className:"small-padding",disabled:r,placeholder:" ",value:t,onChange:e=>i(e.target.value),onBlur:n})})}function tt(e){const{t:t}=Ee(),{value:i,onChange:n,onBlur:r,options:o,...a}=e;return s.jsx(Ze,{...a,children:s.jsx("select",{className:"small-padding",value:i,onChange:e=>n(e.target.value),onBlur:r,children:o.map((e,i)=>s.jsx("option",{value:e.value,children:t(e.label)},e.value+i))})})}function st(e){const{value:t,onChange:i,onBlur:n,className:r,...o}=e;return s.jsx(Ze,{...o,className:$e(r,"textarea min-h-[300px]"),children:s.jsx("textarea",{value:t,placeholder:" ",onChange:e=>i(e.target.value),onBlur:n})})}function it({value:e}){return null}Ye.Header=function({title:e,className:t,...i}){return s.jsx("div",{className:$e(t),...i,children:e&&s.jsx(He,{children:e})})},Ye.Content=function({className:e,...t}){return s.jsx("div",{className:$e(e),...t})},Ye.Footer=function({className:e,...t}){return s.jsx("div",{className:$e("mt-auto",e),...t})};const nt=async()=>{const e=document.createElement("input");return e.type="file",e.accept=".json.gz",new Promise(t=>{e.onchange=async e=>{const s=e.target.files[0],i=await(async e=>{const t=e.stream().pipeThrough(new DecompressionStream("gzip")),s=await new Response(t).text();return JSON.parse(s)})(s);t(i)},e.click()})};function rt({title:e,onClose:t}){const{t:i}=Ee();return s.jsxs("dialog",{open:!0,children:[s.jsx("h5",{children:e}),s.jsx("div",{}),s.jsxs("nav",{className:"right-align no-space",children:[s.jsx("button",{className:"transparent link",onClick:()=>t(!1),children:i("no")}),s.jsx("button",{className:"transparent link",onClick:()=>t(!0),children:i("yes")})]})]})}const ot=e.createContext(null),at=()=>{const t=e.useContext(ot);if(!t)throw new Error("useNotifications must be used inside AppProvider");return t},lt=({children:t})=>{const[i,n]=e.useState([]),[r,a]=e.useState({opts:null});return s.jsxs(ot.Provider,{value:{notify:(e,t="default")=>{const s=Date.now();n(i=>[...i,{id:s,message:e,type:t}]),setTimeout(()=>n(e=>e.filter(e=>e.id!==s)),3e3)},confirm:e=>new Promise(t=>{a({opts:e,resolve:t})})},children:[t,o.createPortal(s.jsx(s.Fragment,{children:i.map((e,t)=>s.jsx("div",{className:$e("snackbar active",e.type),children:e.message},e.message+t))}),document.body),r.opts&&o.createPortal(s.jsx(rt,{title:r.opts.message,onClose:e=>{r.resolve?.(e),a({opts:null})}}),document.body)]})},ct=[{value:"question",label:"question"},{value:"sentence",label:"sentence"},{value:"story",label:"story"}],dt=[{value:"true",label:"yes"},{value:"false",label:"no"}],ut=[{value:"",label:"-"},{value:"text",label:"speak-text"},{value:"options",label:"speak-options"},{value:"text options",label:"speak-text-options"}],pt=e=>{const{course:t,topics:s,items:i}=e;return{courses:[{...t,iconName:t?.iconName||void 0}],topics:s.map(e=>({...e,cid:t.id,shuffle:"false"!==e.shuffle})),items:i.map(e=>({...e,cid:t.id,solution:"sentence"===e.type?e.solution[0]:e.solution,words:"sentence"===e.type?e.solution[0].split(" ").concat(e.options).filter(Boolean):void 0,options:"sentence"===e.type?void 0:e.options}))}},ht={course:{id:ze().trim().lowerCase().schema(),name:ze().trim().schema(),iconName:Te().trim().lowerCase().schema()},topics:{id:ze().trim().lowerCase().unique("topics","id","Topic with same Id exists").schema(),name:ze().trim().schema()},items:{id:ze().trim().lowerCase().unique("items","id","Item with same Id exists").schema(),text:ze().trim().schema(),solution:ze().trim().schema(),options:Te().trim().schema(),speakLang:Te().trim().oneOf(["en","it"]).lowerCase().schema()}},mt=[e=>new Set([...e.topics.map(e=>e.id)]).size!=e.topics.length?"Topic Ids must be unique":null,e=>e.items.some(e=>("question"===e.type||"story"===e.type)&&e.options.length<1)?"At least one option is required":null,e=>e.items.some(e=>("question"===e.type||"story"===e.type)&&e.options.length!==new Set(e.options).size)?"Options must be unique":null,e=>e.items.some(e=>e.speak&&!e.speakLang)?"Speak language is required when speak is set":null];function xt(t){const{t:i}=Ee(),{importCourse:n}=oe(),{notify:r,confirm:o}=at(),a=Se((e=>({course:{id:e.course.id,name:e.course.name,iconName:e.course.iconName||"school"},topics:e.topics.map(e=>({id:e.id,cid:e.cid,name:e.name,shuffle:!1===e.shuffle?"false":"true"})),items:e.items.map(e=>{const{id:t,tid:s,cid:i,type:n,text:r,solution:o,speak:a,speakLang:l}=e,c={speak:a,speakLang:l};return{id:t,tid:s,cid:i,type:n||"question",text:r,solution:"sentence"===n?[o]:o,options:"sentence"===n?e.words.slice(o.split(" ").length):e.options,...c}}),selectedTopicId:e.topics?.[0]?.id??""}))(t),ht,mt),{register:l,setValue:c}=a,{course:d,selectedTopicId:u,topics:p,items:h}=a.values;e.useEffect(()=>{p.length>0&&!p.find(e=>e.id===u)?c("selectedTopicId",p[0].id):0===p.length&&u&&c("selectedTopicId","")},[p,u,c]);const m=async e=>{await o({message:i("are.you.sure")})&&("topics"===e.path&&a.setValue("items",a.values.items.filter(t=>t.tid!==p[e.index].id)),a.removeFromArray(e.path,e.index))},[x,f]=e.useState([{active:!0,label:i("course"),value:"course"},{active:!1,label:i("topics"),value:"topics"},{active:!1,label:i("questions"),value:"questions"}]),g=[!0,Boolean(d?.id),p.length>0];return s.jsxs("form",{className:"pt-sp2",children:[s.jsx("div",{className:"tabs",children:x.map((e,t)=>s.jsx("a",{className:$e("tab",e.active&&"active",!g[t]&&"disabled"),onClick:()=>g[t]&&f(e=>e.map((e,s)=>({...e,active:t===s}))),children:e.label},e.label))}),s.jsxs("div",{className:$e("page pt-sp4",x[0].active&&"active"),children:[s.jsx(et,{disabled:p.length>0,label:"Id",...l("course.id")}),s.jsx(et,{label:"name",...l("course.name")}),s.jsx(et,{label:"icon",...l("course.iconName")}),s.jsx("i",{children:d.iconName}),s.jsx(it,{value:d})]}),s.jsxs("div",{className:$e("page pt-sp4",x[1].active&&"active"),children:[p.map((e,t)=>s.jsxs("details",{children:[s.jsxs("summary",{className:"flex primary-text large-text",children:[e.name,s.jsx("i",{className:"ml-auto small",onClick:e=>{e.stopPropagation(),e.preventDefault(),m({index:t,path:"topics"})},children:"delete"})]}),s.jsxs(s.Fragment,{children:[s.jsx(et,{label:"Id",...l(`topics[${t}].id`),disabled:h.some(t=>t.tid===e.id)}),s.jsx(et,{label:"name",...l(`topics[${t}].name`)}),s.jsx(tt,{label:"shuffle",options:dt,...l(`topics[${t}].shuffle`)})]})]},t)),s.jsxs("button",{type:"button",className:"small m-0 mt-sp2",onClick:()=>{const e=d.id+"_"+(p.length+1);a.addToArray("topics",{id:e,cid:d.id,name:"<new>",shuffle:"false"})},children:[s.jsx("i",{children:"add"}),i("course.add-topic")]}),s.jsx(it,{value:p})]}),s.jsxs("div",{className:$e("page pt-sp4",x[2].active&&"active"),children:[s.jsx(tt,{label:"topic",options:p.map(e=>({value:e.id,label:e.name})),...l("selectedTopicId")}),h.map((e,t)=>e.tid===u?s.jsxs("details",{children:[s.jsxs("summary",{className:"flex primary-text large-text",children:[e.id,s.jsx("i",{className:"ml-auto small",onClick:e=>{e.stopPropagation(),e.preventDefault(),m({index:t,path:"items"})},children:"delete"})]}),s.jsxs(s.Fragment,{children:[s.jsx(et,{label:"Id",...l(`items[${t}].id`)}),s.jsx(tt,{label:"type",options:ct,...l(`items[${t}].type`)}),"story"===e.type?s.jsx(st,{label:"text",...l(`items[${t}].text`)}):s.jsx(et,{label:"text",...l(`items[${t}].text`)}),s.jsx(et,{label:"solution",...l(`items[${t}].solution[0]`)}),(void 0===e.type||"sentence"===e.type||"question"===e.type||"story"===e.type)&&s.jsxs(s.Fragment,{children:[e.options?.map((e,n)=>s.jsxs("div",{className:"grid no-space",children:[s.jsx(et,{label:i("option")+` ${n+1}`,...l(`items[${t}].options[${n}]`),className:"s11"},n),s.jsx("i",{className:"ml-auto small s1",onClick:e=>{e.stopPropagation(),e.preventDefault(),m({index:n,path:`items[${t}].options`})},children:"delete"})]},`items[${t}].options[${n}]`)),s.jsxs("button",{type:"button",className:"small m-0 mt-sp2",onClick:()=>a.addToArray(`items[${t}].options`,""),children:[s.jsx("i",{children:"add"}),i("course.add-option")]})]}),s.jsx(tt,{label:"speak",options:ut,...l(`items[${t}].speak`)}),s.jsx(et,{label:"speak-language",...l(`items[${t}].speakLang`)})]}),s.jsx("hr",{})]},t):null),u&&s.jsxs("button",{type:"button",className:"small m-0 mt-sp2",onClick:()=>a.addToArray("items",{id:u+"_"+(h.filter(e=>e.tid===u).length+1),tid:u,cid:d.id,type:"question",text:"",solution:[""],options:[]}),children:[s.jsx("i",{children:"add"}),i("course.add-item")]}),s.jsx(it,{value:h.filter(e=>e.tid===u)})]}),a.formErrors.length>0&&s.jsx("div",{className:"error-text",children:s.jsx("ul",{children:a.formErrors.map((e,t)=>s.jsx("li",{children:e},t))})}),s.jsxs("button",{type:"button",className:"small-round m-0 mt-sp4",onClick:async()=>{if(await a.validateAll()&&await o({message:i("are.you.sure")}))try{return await n(pt(a.values)),r(i("course.saved"))}catch(e){console.error(e)}r(i("course.save-failed"),"error")},children:[s.jsx("i",{children:"save"}),i("save")]}),s.jsxs("button",{type:"button",className:"small-round m-0 mt-sp4 ml-sp2",onClick:async()=>{await a.validateAll()&&(async(e,t="data.json.gz")=>{const s=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}).stream().pipeThrough(new CompressionStream("gzip")),i=await new Response(s).blob(),n=URL.createObjectURL(i),r=document.createElement("a");r.href=n,r.download=t,r.click(),URL.revokeObjectURL(n)})(pt(a.values),d.name+".json.gz")},children:[s.jsx("i",{children:"download"}),i("export")]})]})}function ft(){const{t:e}=Ee(),{courseId:t=""}=a(),{coursesById:i,topicsByCourseId:n,questionsByCourseId:r}=ne(),o="new"===t?{id:"",name:"untitled"}:i[t];if(!t||!o||q(t))return s.jsx(l,{to:"/extensions",replace:!0});const c="new"===t?[]:[...n[t].map(e=>({...e}))],d="new"===t?[]:[...r[t].map(e=>({...e}))];return s.jsxs(Ye,{children:[s.jsx(Ye.Header,{title:e("edit")}),s.jsx(Ye.Content,{children:s.jsx(xt,{course:o,topics:c,items:d})})]})}const gt={list:"_list_9zeff_1",item:"_item_9zeff_1",canTogggle:"_canTogggle_9zeff_10",toggle:"_toggle_9zeff_15",details:"_details_9zeff_19",open:"_open_9zeff_29"};function jt({children:e}){return s.jsx("ul",{className:$e(gt.list,"list border"),children:e})}function vt({svg:e,iconName:t}){return e?s.jsx(Re,{svg:e,size:1.5}):t?s.jsx("i",{children:t}):s.jsx("i",{children:"extension"})}function yt(){const{t:t}=Ee(),{importCourse:i,toggleCourse:n,deleteCourse:r}=oe(),{courses:o}=ne(),a=c(),{confirm:l,notify:d}=at(),[u,p]=((t,s="")=>{const[i,n]=e.useState(()=>{try{return window.localStorage.getItem(t)||s}catch{return s}}),r=e.useCallback(e=>{try{n(e),window.localStorage.setItem(t,e)}catch{}},[t]);return e.useLayoutEffect(()=>{try{const e=window.localStorage.getItem(t);e&&n(e)}catch{}},[t]),[i,r]})("extensions"),h=e.useMemo(()=>JSON.parse(u||"{}"),[u]);return s.jsxs(Ye,{children:[s.jsx(Ye.Header,{title:t("extensions")}),s.jsxs(Ye.Content,{children:[s.jsx(jt,{children:o.map(e=>s.jsx(jt.Item,{text:e.name,head:s.jsx(vt,{...e}),tail:s.jsxs("span",{className:"ml-auto flex",children:[s.jsxs("label",{className:"switch ml-auto",children:[s.jsx("input",{type:"checkbox",checked:!1!==h[e.id],onChange:t=>{const s={...h,[e.id]:t.target.checked};t.target.checked&&delete s[e.id],p(JSON.stringify(s)),n(e.id)}}),s.jsx("span",{})]}),s.jsx("button",{className:"transparent circle ml-sp3",disabled:q(e.id),onClick:()=>a(`/edit/${e.id}`),children:s.jsx("i",{className:$e("large",q(e.id)&&"disabled"),children:"edit"})}),s.jsx("button",{className:"transparent circle no-margin",disabled:q(e.id),onClick:()=>(async e=>{if(q(e))return;if(!o.find(t=>t.id===e))return;await l({message:t("are.you.sure")})&&r(e)})(e.id),children:s.jsx("i",{className:$e("large",q(e.id)&&"disabled"),children:"delete"})})]})},e.id))}),s.jsxs("div",{className:"center-align large-padding",children:[s.jsxs("button",{onClick:async()=>{try{const e=await nt();await i(e),d(t("course.imported"))}catch(e){d(t("course.import-failed"),"error"),console.error("Failed to copy: ",e)}},type:"button",className:"mt-sp2 small-round",children:[s.jsx("i",{children:"upload"}),t("import")]}),s.jsxs("button",{onClick:()=>a("/edit/new"),type:"button",className:"mt-sp2 small-round",children:[s.jsx("i",{children:"add"}),t("new")]})]})]})]})}jt.Item=function({head:t,tail:i,text:n,subText:r,children:o,className:a}){const[l,c]=e.useState(!1),d=e.useCallback(e=>e.stopPropagation(),[]),u=e.useCallback(()=>c(!l),[l,c]);return Array.isArray(o)&&o.every(e=>void 0===e)&&(o=void 0),s.jsxs("li",{className:$e(gt.item,"no-margin",o&&gt.canTogggle,a),onClick:o?u:void 0,children:[s.jsxs("div",{className:$e(gt.headline,"flex items-center max"),children:[t,(n||r)&&s.jsxs("div",{className:$e("ml-sp2 wrap-auto"),children:[s.jsx("strong",{children:n}),r&&s.jsx("div",{className:"italic",children:r})]}),i]}),o&&s.jsx("button",{className:$e(gt.toggle,"circle transparent"),children:s.jsx("i",{children:l?"expand_less":"expand_more"})}),o&&s.jsx("div",{className:$e(gt.details,l&&gt.open),onClick:d,children:o})]})};const bt=()=>{const t=_t(),s=Ne(),{updateProfile:i}=Ce(),n=e.useCallback(()=>{if(t&&t.isFinished&&t.id>0){const e=function(e={},t){const{wrong:s,wrongCount:i,questions:n}=t,r=t.topicId,o=(t.time+(e[r]||t.time))/2,a=(e.keys||"").split(" ");0!==i||a.includes(r)||a.push(r);const l={...e,[r]:o,keys:a.join(" ").trim()};return n.forEach(({id:e})=>{const t=s[e],i=Number(l[e]||0);l[e]=t?3:Math.max(i-1,0)}),l}(s.stats,t);return i({...s,stats:e}),!0}return!1},[t,s,i]);return((t,s)=>{let i=!0;const n=e.useRef(null);e.useEffect(()=>{if(null!=t)return n.current!==t&&Promise.resolve(s()).then(e=>{i&&e&&(n.current=t)}),()=>{i=!1}},[t,s])})(t?.id,n),null},wt="quiz/start",Nt="quiz/finish",kt="quiz/solution-given",[Ct,_t,$t]=S((e,t)=>{switch(t.type){case wt:return{...t.payload};case Nt:return!e||e.isFinished?e:{...e,...je(e),isFinished:!0,time:Date.now()-e.start,ts:Date.now()};case kt:{if(!e||e.isFinished)return e;const{id:s,solution:i}=t.payload,{questions:n}=e;return{...e,questions:n.map(e=>e.id===s?{...e,givenSolution:i}:{...e})}}default:throw new Error(`Unknown questions event: ${JSON.stringify(t)}`)}},void 0,"quiz"),St=()=>{const t=$t(),{questionsById:s,questionsByTopicId:i,topicsById:n}=ne(),{stats:r}=Ne();return{startQuiz:e.useCallback(async(e,o=[])=>{const a=!1!==n[e]?.shuffle,l=await fe(s,i,e,a,r,o.length,o);return t({type:wt,payload:l}),new Promise(e=>setTimeout(e,100))},[t,s,i,r,n]),finishQuiz:e.useCallback(async()=>(t({type:Nt}),new Promise(e=>setTimeout(e,100))),[t]),solve:e.useCallback((e,s)=>{t({type:kt,payload:{id:e,solution:s}})},[t])}},qt=({children:e})=>s.jsxs(Ct,{children:[s.jsx(bt,{}),e]});function It(){const{t:i}=Ee(),o=c(),a=r(),{startQuiz:l}=St(),d=ne(),{questionsByTopicId:u,courses:p,topicsByCourseId:h}=d,{stats:{keys:m}}=Ne(),x=a.pathname.substring(1)||p[0]?.id,f=e.useMemo(()=>h[x]||[],[h,x]),g=e.useMemo(()=>{const e=new Set;return f.forEach((t,s,i)=>{s>0&&((e,t="")=>(e.startsWith("en")||e.startsWith("it"))&&!t.includes(e))(i[s-1].id,m)&&e.add(t.id)}),e},[f,m]);return s.jsxs(Ye,{children:[s.jsx(Ye.Header,{title:i("home")}),s.jsx(Ye.Content,{children:f.filter(e=>u[e.id].length).map(({id:e,name:i},r)=>{return s.jsxs(t.Fragment,{children:[s.jsxs("div",{className:$e("flex items-center",(r+1)%3!=0&&"pb-sp1"),children:[s.jsx("button",{disabled:g.has(e),className:$e("responsive small-round m-0 mr-sp1"),onClick:()=>(e=>{l(e).then(()=>o("/quiz"))})(e),children:i}),(a=e,c=g.has(e),u[a]?.[0]?.vocab&&!c?s.jsx(n,{to:`/words/${a}`,children:s.jsx("i",{className:"large",children:"import_contacts"})}):a.startsWith("mul")?s.jsx(n,{to:"/mtable",children:s.jsx("i",{className:"large",children:"import_contacts"})}):a.startsWith("div")?s.jsx(n,{to:"/dtable",children:s.jsx("i",{className:"large",children:"import_contacts"})}):c?s.jsx("div",{children:s.jsx("i",{className:"large",children:"lock"})}):s.jsx("div",{children:s.jsx("i",{className:"large",children:" "})}))]}),r+1<f.length&&(r+1)%3==0&&s.jsx("hr",{className:"small"})]},r);var a,c})})]})}let Bt=null,Et=null;const Pt=/\([^)]+\)/gm,zt=(e,t="en",s=()=>{},i=()=>{})=>{if(!e)return;if(!xe){const s=(e=>{const t=[M(e)];for(let s=0;s<6;s++)t.push(M(t[s]+e));return t.join("").slice(-32)})(e);return Et&&(Et.pause(),Et=null),t=t.split("-")[0],Et=new Audio(`/audio/${t}/${s}.oga`),void Et.play()}const n=window.speechSynthesis;Bt&&n.cancel(),e=e.replace(Pt,"").trim(),Bt=new SpeechSynthesisUtterance(e),t.startsWith("it")?(Bt.lang="it-IT",Bt.rate=1):(Bt.lang="en-US",Bt.rate=.8),s&&Bt.addEventListener("start",s),i&&Bt.addEventListener("end",i),n.speak(Bt)},Tt=({text:t,lang:i="en",className:n="small",asLink:o=!1,size:a,children:l})=>{const{pathname:c}=r();c.includes("/en")&&(i="en"),c.includes("/it")&&(i="it"),e.useEffect(()=>()=>{window.speechSynthesis.cancel()},[]);const d=e.useCallback(e=>{e.stopPropagation(),zt(t,i)},[t,i]),u=o?"a":"button";return s.jsx(u,{onClick:d,className:$e("border small-round square",n),children:l||s.jsx("i",{className:$e("fill",a),children:"volume_up"})})},At={backgroundColor:"var(--highlight)"},Ot=({parts:e,n:t})=>s.jsx("p",{style:{whiteSpace:"pre-line"},children:e.map((e,i)=>s.jsx("span",{className:"medium-line",style:i===t?At:void 0,children:e+" "},i))}),Ft=/ \(=[^)]+\)/gm,Lt=({text:t,lang:i="en"})=>{const[n]=e.useState((e=>{const t=[],s=new Set([",",".","!","?",":",";","”",'"']);let i=[],n=0;const r=()=>{const e=i.length>0?i.join(""):"";e&&"."!==e&&t.push(e)};let o="";for(;n<e.length;){const t=e[n];o||"“"!==t&&'"'!==t?("“"===o&&"”"===t||'"'===o&&'"'===t)&&(o=""):o=t,i.push(t),!o&&s.has(t)&&(r(),i=[]),n++}return r(),{read:t.map(e=>e.replace(Ft,"").trim()),parts:t}})(t)),[r,o]=e.useState(-1);e.useEffect(()=>()=>{window.speechSynthesis.cancel()},[]);const a=e.useCallback(()=>{const e=t=>{zt(n.read[t],i,()=>o(t),()=>t===n.read.length?o(-1):e(t+1))};e(0)},[i,n]);return s.jsxs("div",{children:[s.jsx("button",{onClick:a,className:"border small-round square m-0",children:s.jsx("i",{className:"fill",children:"volume_up"})}),s.jsx(Ot,{parts:n.parts,n:r})]})},Dt="_explanation_vado5_1";function Mt({topicId:e,text:t,subText:i,svg:n,explanation:r,body:o,footer:a,speak:l,speakLang:c,read:d}){return s.jsxs(Ye,{children:[s.jsxs(Ye.Content,{children:[n&&n.length>0&&s.jsx("div",{className:"small-padding flex",children:n.map((e,t)=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:e.width,height:e.height,viewBox:e.viewBox,className:e.className,dangerouslySetInnerHTML:{__html:e.g}},e.width+"-"+t))}),t&&s.jsxs("div",{className:"r",children:[!d&&s.jsxs("div",{className:"le",children:[!d&&s.jsx("h6",{className:"bold small-padding",children:t}),l&&s.jsx("div",{className:"mb-sp2",children:s.jsx(Tt,{text:l,lang:c||e,className:""})})]}),d&&s.jsx("div",{className:"h5 small-padding",children:s.jsx(Lt,{text:d,lang:c||e})}),i&&s.jsx("div",{children:i})]}),o&&s.jsx(o,{}),r&&s.jsx("p",{className:Dt,children:r})]}),s.jsx(Ye.Footer,{children:a&&s.jsx(a,{})})]})}const Qt="_option_1pb6x_1",Rt="_max_1pb6x_8",Vt="_sentence_elsah_1";function Wt({disabled:t=!1,correct:i,solution:n="",words:r=[],onFinish:o=()=>{}}){const{t:a}=Ee(),[l,c]=e.useState(n?D(n).map(e=>r.indexOf(e)):[]);if(t){const e=i!==(n=function(e,t){for(const s of[".","?","!"])if(e.endsWith(s)&&!t.endsWith(s))return t+s;return t}(i,n));return s.jsxs("div",{className:$e("flex flex-col"),children:[e&&s.jsx("button",{disabled:!0,className:$e("border small-round large error",Qt),children:n}),s.jsx("button",{disabled:!0,className:$e("border small-round large success",Qt),children:i})]})}return s.jsxs("div",{className:$e("flex flex-col"),children:[s.jsx("div",{className:Vt,children:l.map((e,t)=>s.jsx("button",{className:$e("chip tiny-margin",r.length<5&&"large"),onClick:()=>c(l.filter(t=>t!==e)),children:r[e]},t))}),s.jsx("br",{}),s.jsx("div",{className:"center-align",children:r.map((e,t)=>s.jsx("button",{className:$e("chip tiny-margin",l.includes(t)?"":"inverse-primary-border",r.length<5&&"large"),disabled:l.includes(t),onClick:()=>c([...l,t]),children:(l.includes(t),e)},t))}),s.jsx("br",{}),!1===t&&s.jsx("button",{className:"border small-round large fill",onClick:()=>o((e=>e.join(" ").replaceAll("’ ","’").replaceAll(" po’"," po’ "))(l.map(e=>r[e]))),children:a("next")})]})}function Ht({options:e,checked:t=[],onChange:i,disabled:n,getClassName:r=()=>"",long:o,speak:a,speakLang:l,topicId:c}){return s.jsx("div",{className:"flex flex-col",children:e.map((e,d)=>n?s.jsx("button",{disabled:!0,className:$e("border small-round large",Qt,r(d).includes("success")?"success":t.includes(d)?"error":"fill",o?"responsive":Rt),onClick:()=>i(d,!0,{replace:!0}),children:e},d):s.jsxs("div",{className:"flex",children:[s.jsx("button",{className:$e("border small-round large",Qt,t.includes(d)?"primary":"fill",o?"responsive":Rt),onClick:()=>i(d,!0,{replace:!0}),children:e}),a&&s.jsx(Tt,{text:e,lang:l||c,className:"large"})]},d))})}class Ut extends t.Component{state={givenSolution:void 0,questionId:""};static getDerivedStateFromProps(e,t){const s=e.currentQuestion;return s&&s.id!==t.questionId?{givenSolution:s.givenSolution,questionId:s.id}:null}onSolution=(e,t,{replace:s}={replace:!1})=>{let i=this.state.givenSolution;i="string"==typeof e?e:t&&s?[e]:t?[...i,e]:i.filter(t=>t!==e),this.setState({givenSolution:i},()=>this.props.nextQuestionNumber?this.onNext():this.onFinish())};onPrev=()=>this.props.navigate(`/quiz/${this.props.prevQuestionNumber}`);onNext=()=>{const{navigate:e,solve:t,nextQuestionNumber:s}=this.props,{questionId:i,givenSolution:n}=this.state;t(i,n),e(`/quiz/${s}`)};onFinish=()=>{const{questionId:e,givenSolution:t}=this.state;this.props.solve(e,t),this.props.finishQuiz(),this.props.navigate("/quiz/results")};getClassName=e=>{const{quiz:t,currentQuestion:s}=this.props;if(t.isFinished){const i=s.id;if(t.correct[i].includes(e))return $e("success")}return""};render(){const{t:e,currentQuestion:t,showResults:n,nextQuestionNumber:r,prevQuestionNumber:o,quiz:a}=this.props;if(!t)return this.props.navigate("/");if(n)return this.props.navigate("/quiz/results");const{type:l,text:c,options:d,words:u,svg:p,speak:h="",speakLang:m}=t,{givenSolution:x,questionId:f}=this.state,g=a.explanation&&a.explanation[f],j=this.props.quiz.isFinished;return s.jsx(Mt,{topicId:a.topicId,text:c,svg:p,explanation:g,body:()=>"sentence"===l?s.jsx(Wt,{disabled:j,solution:x,correct:a.correct?.[f],words:u,onFinish:e=>this.onSolution(e,!0,{replace:!0})}):s.jsx(Ht,{topicId:a.topicId,checked:x,options:d,getClassName:this.getClassName,disabled:j,onChange:this.onSolution,speak:h.includes("options"),speakLang:m,long:Boolean(h)},f),footer:()=>s.jsxs("div",{className:"center-align large-padding",children:[s.jsxs("div",{className:"large-padding",children:[s.jsx("button",{className:"no-padding square",onClick:this.onPrev,disabled:!o,children:s.jsx("i",{children:"chevron_backward"})}),s.jsxs("span",{children:[this.props.questionNumber," / ",this.props.questionCount]}),s.jsx("button",{className:"no-padding square",onClick:this.onNext,disabled:!r,children:s.jsx("i",{children:"chevron_forward"})})]}),this.props.quiz.isFinished?s.jsx(i,{to:"/quiz/results",children:s.jsx("button",{className:"fill small-round",children:e("results")})}):s.jsx("button",{className:"fill small-round",onClick:this.onFinish,children:e("finish")})]}),speakLang:m,speak:h.includes("text")?c:void 0,read:"story"===l?c:void 0})}}const Jt=(Kt=Ut,function(e){const{t:t}=Ee(),i=c(),n=a(),{solve:r,finishQuiz:o}=St(),l=_t(),d=Number(n.questionNumber||1),u=l?.questions?.length??0,p=d>1?d-1:void 0,h=d<u?d+1:void 0,m={...e,t:t,navigate:i,params:n,solve:r,finishQuiz:o,quiz:l,questionNumber:d,questionCount:u,currentQuestion:l.questions[d-1],prevQuestionNumber:p,nextQuestionNumber:h,showResults:!n.questionNumber&&l.isFinished};return s.jsx(Kt,{...m})});var Kt;const Gt="_numbers_kwdjd_1",Yt="_number_kwdjd_1",Xt=["#f44336","#e91e63","#9c27b0","#673ab7","#3f51b5","#2196f3","#03a9f4","#00bcd4","#009688","#4CAF50","#8BC34A","#CDDC39","#FFEB3B","#FFC107","#FF9800","#FF5722","#795548"];function Zt(){const t=e.useRef(null);return e.useEffect(()=>{if(t.current){new d(t.current,{colors:Xt,particleCount:50,force:.3}).explode()}},[]),s.jsx("div",{ref:t,style:{position:"relative",left:"30%",height:"2px"}})}const es=()=>{const{t:e}=Ee(),t=c(),i=_t(),{startQuiz:r}=St(),{questions:o,wrongCount:a,wrong:l,time:d,ts:u}=i,p=a?`${e("errors")}: ${a}`:e("all-correct"),h=`${e("time")}: ${A(d/1e3)}`;if(!i.isFinished)return s.jsx("div",{children:"No quiz"});return s.jsxs("div",{children:[s.jsx("h6",{children:p}),s.jsx("h6",{children:h}),(0===a?Date.now()-u<2e3:ce)&&s.jsx(Zt,{}),s.jsx("ul",{className:Gt,children:o.map((e,t)=>((e,t,i)=>{const r=e.id in i?"error":"success";return s.jsx("li",{className:$e(r,Yt),children:s.jsx(n,{to:`/quiz/${t}`,children:t})},t)})(e,`${t+1}`,l))}),s.jsx("button",{className:"fill small-round",onClick:()=>{r(i.topicId).then(()=>t("/quiz"))},children:e("repeat")})]})},ts={circleBg:"_circleBg_lw860_1",circle:"_circle_lw860_1",title:"_title_lw860_13",green:"_green_lw860_21",yellow:"_yellow_lw860_25",red:"_red_lw860_29",value:"_value_lw860_33",up:"_up_lw860_46"},ss=100/(2*Math.PI),is=2*ss,ns=`M 24 2.0845\n   a ${ss} ${ss} 0 0 1 0 ${is}\n   a ${ss} ${ss} 0 0 1 0 -${is}`;function rs({percentage:e=0,className:t,title:i="",value:n,onClick:r=()=>{}}){const o=function(e){if(e>79)return ts.green;if(e>49)return ts.yellow;return ts.red}(e);return void 0===n&&(n=[(e<100?e.toFixed(2):e)+"%"]),s.jsx("div",{className:t,onClick:r,children:s.jsxs("div",{children:[s.jsx("div",{className:$e(ts.value,n.length>1&&ts.up),children:n.map((e,t)=>s.jsx("span",{children:e},t))}),s.jsxs("svg",{viewBox:"0 0 48 48",className:$e(ts.circularChart),children:[s.jsx("path",{className:ts.circleBg,d:ns}),s.jsx("path",{className:$e(ts.circle,o),strokeDasharray:`${e}, 100`,d:ns}),s.jsx("text",{x:24,y:40.8,className:ts.title,children:i})]})]})})}function os({svg:e}){return e?s.jsx(Re,{svg:e,size:1.5}):s.jsx("i",{children:"extension"})}function as(){const{t:t}=Ee(),i=c(),n=ne(),{courses:r,coursesById:o,topicsById:a,questionsByTopicId:l}=n,[d,u]=e.useState(!1),p=Ne(),{resetProfileStats:h}=Ce(),{startQuiz:m}=St(),x=((e,t)=>{const s=t.stats||{},i=Object.entries(s).reduce((e,[t,s])=>{const i=t.split("_")[0];if(i===t)return e;const n=e[i]||{correct:0,total:0};return e[i]={correct:n.correct+(0===s?1:0),total:n.total+1},e},{}),n=Object.keys(e).reduce((t,n)=>{if(Object.hasOwn(i,n)){const{correct:r,total:o}=i[n];t.push({...i[n],tid:n,accuracy:r/o*100,speed:s[n]/1e3,progress:ge(e[n],s).progress})}return t},[]);return Object.entries(n.reduce((t,s)=>{const i=e[s.tid][0].cid;return t[i]=t[i]||[],t[i].push(s),t},{}))})(l,p),f="relative min-w-[100px] max-w-[350px]";return s.jsxs(Ye,{children:[s.jsx(Ye.Header,{title:t("stats")}),s.jsx(Ye.Content,{children:s.jsx(jt,{children:x.map(([e,n])=>{return s.jsx(jt.Item,{text:o[e].name,head:s.jsx(os,{...(l=e,r.find(e=>e.id===l)||r[0])}),children:n.map(e=>s.jsxs("div",{children:[s.jsx("p",{className:"large-text",children:a[e.tid].name}),s.jsxs("div",{className:"grid",children:[s.jsx(rs,{onClick:()=>m(e.tid).then(()=>i("/quiz")),percentage:e.progress,className:$e(f,"s4","cursor-pointer"),title:t("learned")}),s.jsx(rs,{percentage:e.accuracy,className:$e(f,"s4"),title:t("accuracy")}),s.jsx(rs,{percentage:e.speed<50?100:e.speed<70?90:e.speed<140?66:e.speed<210?33:0,value:A(e.speed,!0),className:$e(f,"s4"),title:t("speed")})]})]},e.tid))},e);var l})})}),s.jsxs(Ye.Footer,{children:[x.length>0&&s.jsx("div",{className:"center-align large-padding",children:s.jsx("button",{className:"mt-sp2 small-round",onClick:()=>u(!0),children:t("reset")})}),d&&s.jsx(rt,{title:t("are.you.sure"),onClose:e=>{u(!1),e&&h(p)}})]})]})}function ls({topicId:e,text:t}){return s.jsx(Tt,{asLink:!0,className:"no-border no-padding no-margin small",lang:e,text:t,children:t})}function cs({topicId:e,conjugations:{present:t=[],past:i=[],future:n=[],imperfect:r=[]}}){return s.jsxs("table",{className:$e("border no-space small-text wrap-auto"),onClick:e=>{e.stopPropagation()},children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{}),s.jsx("th",{children:"io"}),s.jsx("th",{children:"tu"}),s.jsx("th",{children:"Lei/lui/lei"}),s.jsx("th",{children:"noi"}),s.jsx("th",{children:"voi"}),s.jsx("th",{children:"loro"})]})}),s.jsxs("tbody",{children:[s.jsxs("tr",{children:[s.jsx("td",{children:s.jsx("span",{className:$e("italic lg"),children:"presente"})}),t.map((t,i)=>s.jsx("td",{children:s.jsx(ls,{topicId:e,text:t})},t+i))]}),s.jsxs("tr",{children:[s.jsx("td",{children:s.jsx("span",{className:$e("italic lg"),children:"passato prossimo"})}),i.map((t,i)=>s.jsx("td",{children:s.jsx(ls,{topicId:e,text:t})},t+i))]}),r.length>0&&s.jsxs("tr",{children:[s.jsx("td",{children:s.jsx("span",{className:$e("italic lg"),children:"imperfetto"})}),r.map((t,i)=>s.jsx("td",{children:s.jsx(ls,{topicId:e,text:t})},t+i))]}),s.jsxs("tr",{children:[s.jsx("td",{children:s.jsx("span",{className:$e("italic lg"),children:"futuro semplice"})}),n.map((t,i)=>s.jsx("td",{children:s.jsx(ls,{topicId:e,text:t})},t+i))]})]})]})}function ds({rows:e=[]}){const[t,...i]=e;return s.jsxs("table",{className:$e("border no-space small-text wrap-auto"),onClick:e=>{e.stopPropagation()},children:[s.jsx("thead",{children:s.jsx("tr",{children:t.map((e,t)=>s.jsx("th",{children:e},e+t))})}),s.jsx("tbody",{children:i.map((e,t)=>s.jsx("tr",{children:e.map((e,t)=>s.jsxs("td",{children:[" ",e," "]},e+t))},t))})]})}function us(){const{id:t}=a(),i=c(),{questionsByTopicId:n,topicsById:r,questionsByParentId:o}=ne(),{startQuiz:l}=St();let d=n[t];const u=d[0];return d=("function"==typeof u.vocab?u.vocab():d).filter(e=>Boolean(e.vocab)),e.useCallback(e=>{const s=e.reduce((e,t)=>{e.push(t.id);const s=o[t.id];return s&&s.length&&e.push(...s.map(e=>e.id)),e},[]);l(t||"",s).then(()=>i("/quiz"))},[t,i,o,l]),d?s.jsxs(Ye,{children:[s.jsx(Ye.Header,{title:r[t].name+` (${d.length})`}),s.jsx(Ye.Content,{children:s.jsx(jt,{children:d.map(e=>s.jsxs(jt.Item,{head:s.jsx(Tt,{text:"object"==typeof e.vocab&&e.vocab?.text||e.text,lang:t,className:"no-padding no-margin"}),text:"object"==typeof e.vocab&&e.vocab?.text||e.text,subText:"object"==typeof e.vocab&&e.vocab?.solution||e.solution[0],children:[e.conjugations?s.jsx(cs,{...e,topicId:t}):void 0,Array.isArray(e.table)?s.jsx(ds,{rows:e.table}):void 0,void 0]},e.id))})})]}):null}function ps(){const{t:e}=Ee();return s.jsxs(u,{children:[s.jsx(p,{path:"/about",element:s.jsx(Xe,{})}),s.jsx(p,{path:"/extensions",element:s.jsx(yt,{})}),s.jsx(p,{path:"/edit/:courseId?",element:s.jsx(ft,{})}),s.jsx(p,{path:"/mtable",element:s.jsx(Ge,{title:e("multi-table")})}),s.jsx(p,{path:"/dtable",element:s.jsx(Ge,{title:e("div-table"),op:"div"})}),s.jsxs(p,{element:s.jsx(hs,{}),children:[s.jsx(p,{path:"/words/:id",element:s.jsx(us,{})}),s.jsx(p,{path:"/stats",element:s.jsx(as,{})}),s.jsx(p,{path:"/quiz/results",element:s.jsx(es,{})}),s.jsx(p,{path:"/quiz/:questionNumber?",element:s.jsx(Jt,{})}),s.jsx(p,{path:"/:course?",element:s.jsx(It,{})})]})]})}function hs(){return s.jsx(qt,{children:s.jsx(h,{})})}function ms(){const t=e.useRef(null),{pathname:i}=r(),{courses:n}=ne(),{loadProfile:o}=Ce(),{loadCourses:a}=oe();return e.useEffect(()=>{o(),a()},[a,o]),e.useLayoutEffect(()=>{t.current?.scrollTo({top:0,left:0,behavior:"instant"})},[i]),s.jsxs(s.Fragment,{children:[s.jsx(We,{}),s.jsx("main",{className:"responsive flex flex-col",ref:t,children:n.length>0?s.jsx(ps,{}):s.jsx("progress",{className:"circle"})}),s.jsx(_e,{})]})}function xs({children:e}){return s.jsx(lt,{children:s.jsx(ie,{children:s.jsx(we,{children:s.jsx(m,{children:e})})})})}x.createRoot(document.getElementById("root")).render(s.jsx(t.StrictMode,{children:s.jsx(xs,{children:s.jsx(ms,{})})}));export{I as a,te as b,B as c,se as v};
